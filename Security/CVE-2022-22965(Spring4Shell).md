# Spring4Shell

ìµœê·¼ Spring Frameworkì—ì„œ ë°œìƒí•œ ì·¨ì•½ì  CVE-2022-22965ë¥¼ ê³µë¶€í•˜ê³  ì‘ì„±í•œ ê¸€ì…ë‹ˆë‹¤. 

LunaSec ë¸”ë¡œê·¸ì— ì˜¬ë¼ì˜¨ ë¶„ì„ê¸€ì„ ì°¸ê³ í•˜ì˜€ìœ¼ë©°, ë§í¬ëŠ” í•˜ë‹¨ `ğŸ”—ì°¸ê³ í•œ ìë£Œ`ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

## ğŸ“–Overview

2022ë…„ 3ì›” 29ì¼ íŠ¸ìœ„í„°ì— Spring Coreì—ì„œì˜ ìƒˆë¡œìš´ ì œë¡œë°ì´ ìµìŠ¤í”Œë¡œì‡ ìŠ¤í¬ë¦°ìƒ·ì´ ê³µê°œë˜ì—ˆë‹¤.

í•´ë‹¹ ì·¨ì•½ì ì€ CVE-2022-22965ëŠ” `Spring4Shell`ì´ë¼ê³ ë„ ì•Œë ¤ì ¸ ìˆìœ¼ë©°, í´ë˜ìŠ¤ ì£¼ì…ì„ í†µí•´ RCEë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆë‹¤. 

Spring Coreê°€ ë§¤ìš° ë§ì´ ì‚¬ìš©ë˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¼ëŠ” ì ì—ì„œ í•´ë‹¹ ì·¨ì•½ì ì˜ íŒŒê¸‰ë ¥ì´ í´ ê²ƒìœ¼ë¡œ ë³´ì¸ë‹¤.

## ğŸ“¢NVD ì •ë³´

> A Spring MVC or Spring WebFlux application running on JDK 9+ may be vulnerable to remote code execution (RCE) via data binding. The specific exploit requires the application to run on Tomcat as a WAR deployment. If the application is deployed as a Spring Boot executable jar, i.e. the default, it is not vulnerable to the exploit. However, the nature of the vulnerability is more general, and there may be other ways to exploit it.

[ğŸ”—CVE-2022-22965 NVD link](https://nvd.nist.gov/vuln/detail/CVE-2022-22965 "CVE-2022-22965 NVD")


## ğŸš«ì·¨ì•½ ì‹œìŠ¤í…œ

* Spring MVC and Spring WebFlux applications running on JDK 9+.
* Spring Framework 5.3.0 - 5.3.17, 5.2.0 - 5.2.19ê³¼ ì´ì „ ë²„ì „.

<pre>
* ê³µê°œëœ íŠ¹ì • ìµìŠ¤í”Œë¡œì‡ì— ëŒ€í•´ì„œëŠ” ë‹¤ìŒì„ ëª¨ë‘ ë§Œì¡±í•˜ëŠ” ê²½ìš° ì·¨ì•½í•˜ë‹¤ê³  í•  ìˆ˜ ìˆë‹¤.
  (í•˜ì§€ë§Œ ìµìŠ¤í”Œë¡œì‡ì´ ê°€ëŠ¥í•œ ì´ì™¸ì˜ ì‹œë‚˜ë¦¬ì˜¤ê°€ ìˆì„ ìˆ˜ ìˆìŒ.)
  
1. JDK 9 ì´ìƒì˜ ë²„ì „ì—ì„œ ì‹¤í–‰
  (JDK 8ì—ì„œëŠ” ì·¨ì•½í•˜ì§€ ì•ŠìŒ.)
2. Servlet ì»¨í…Œì´ë„ˆë¡œ Apache Tomcatì„ ì‚¬ìš©
3. WAR deploymentë¥¼ í†µí•´ Tomcatì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ê²½ìš°
  (Spring Boot executable jarë¡œ ë°°í¬ëœ ê²½ìš°ì—ëŠ” ì·¨ì•½í•˜ì§€ ì•ŠìŒ.)
4. spring-webmvc ë˜ëŠ” spring-webflux ì¢…ì†ì„±
5. Spring Framework 5.3.0 - 5.3.17, 5.2.0 - 5.2.19ê³¼ ì´ì „ ë²„ì „
</pre>

## ğŸ©¹ì·¨ì•½ì  íŒ¨ì¹˜

íŒ¨ì¹˜ëœ ë²„ì „ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

<pre>
Spring Framework 5.3.18, 5.2.20
Spring Boot 2.6.6, 2.5.12 (Spring Framework 5.3.18 ê¸°ë°˜) 
</pre>

## ğŸ“šë¶„ì„í•œ ë‚´ìš©

CVE-2022-22965ëŠ” ìš”ì²­ íŒŒë¼ë¯¸í„°ì˜ ê°’ìœ¼ë¡œ ê°ì²´ë¥¼ ì±„ìš¸ ë•Œ ì‚¬ìš©ë˜ëŠ” ë°ì´í„° ë°”ì¸ë”©ê³¼ ì—°ê´€ì´ ìˆë‹¤.
ë°ì´í„° ë°”ì¸ë”© ê³¼ì •ì—ì„œ ì‚¬ìš©ìê°€ ì „ì†¡í•œ HTTP ìš”ì²­ ê°’ì— ë”°ë¼ ë‹¤ë¥¸ ê°ì²´ë¡œì˜ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ì—¬ ë°œìƒí•˜ëŠ” ì·¨ì•½ì ìœ¼ë¡œ, ì´ë¥¼ ì•…ìš©í•˜ë©´ ì›ê²© ì½”ë“œ ì‹¤í–‰(RCE)ìœ¼ë¡œ ì´ì–´ì§ˆ ìˆ˜ ìˆë‹¤.

ì·¨ì•½ì ì„ ë¶„ì„í•˜ê¸° ìœ„í•´ LunaSecì—ì„œ Githubì— ê³µê°œí•œ ì·¨ì•½í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ PoCë¥¼ í™œìš©í–ˆë‹¤. 

### âœë°ì´í„° ë°”ì¸ë”©

ì„œë²„ì— ë‹¤ìŒê³¼ ê°™ì€ í´ë˜ìŠ¤ê°€ ìˆë‹¤ê³  í•  ë•Œ, 
```java
public class Greeting {
    private long id;

    public long getId() {
        return id;
    }

    public void setId(long id) {
        this.id = id;
    }
}

@Controller
public class HelloController {
    @PostMapping("/greeting")
    public String greetingSubmit(@ModelAttribute Greeting greeting, Model model) {
        return "hello";
    }
}
```

ì‚¬ìš©ìê°€ ë‹¤ìŒê³¼ ê°™ì´ ìš”ì²­ì„ ë³´ë‚´ë©´ ìœ„ì˜ Greeting í´ë˜ìŠ¤ì— ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì¸ `id=test` ì˜ ë°ì´í„°ê°€ ë°”ì¸ë”©ë˜ì–´ Greeting ê°ì²´ì˜ `id` ê°’ì´ `test`ë¡œ ì„¸íŒ…ëœë‹¤.

```bash
curl 'http://localhost:8080/greeting?id=test'
```

ì´ ë•Œ, ìœ„ì™€ ê°™ì€ ì¼ë°˜ì ì¸ íŒŒë¼ë¯¸í„° ê°’ë¿ë§Œ ì•„ë‹ˆë¼ ê°ì²´ ì†ì„±ì— ëŒ€í•´ì„œë„ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ëœ ê°’ì„ ë°”ì¸ë”©í•  ìˆ˜ ìˆë‹¤. 
ì´ì²˜ëŸ¼ ê°ì²´ ì†ì„±ì— íŒŒë¼ë¯¸í„° ê°’ì„ ë°”ì¸ë”©í•˜ê¸° ìœ„í•´ì„œëŠ” ëŸ°íƒ€ì„ì— ê°ì²´ì— ì ‘ê·¼í•  ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

ê°ì²´ ì§€í–¥ ì–¸ì–´ì—ì„œ ëŸ°íƒ€ì„ì— í´ë˜ìŠ¤ í˜¹ì€ ê°ì²´ì˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ê±°ë‚˜ ì‚¬ìš©ë„ë¡ í—ˆìš©í•´ì£¼ëŠ” ê²ƒì´ Introspectionì´ë¼ê³  í•˜ëŠ”ë°,
Introspectionì€ Introspector í´ë˜ìŠ¤ì˜ ë‹¤ìŒ ë‘ ê°œì˜ ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ì—¬ ìˆ˜í–‰ëœë‹¤.

```java
BeanInfo getBeanInfo(Class beanClass)
BeanInfo getBeanInfo(Class beanClass, Class stopClass)
```
íŠ¹íˆ, Spring Frameworkì—ì„œëŠ” ìœ„ì˜ ë‘ ë©”ì†Œë“œ ì¤‘ `getBeanInfo(Class beanClass)`ë¥¼ ì‚¬ìš©í•˜ë©°, 
ì´ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•´ ë§¤ê°œ ë³€ìˆ˜ `beanClass`ë¡œ ì „ë‹¬ëœ ê°ì²´ì— ëŒ€í•œ ì •ë³´ë¥¼ ê°€ì ¸ì˜¨ë‹¤.

ì´ ë•Œ, `getBeanInfo(Class beanClass)`ì˜ ê²½ìš° `stopClass`ì— í•´ë‹¹í•˜ëŠ” ì¸ìê°€ ì—†ê¸° ë•Œë¬¸ì— ì „ì²´ ìƒì† íŠ¸ë¦¬ë¥¼ ëª¨ë‘ ìˆœíšŒí•˜ì—¬ `beanClass`ì— ì§€ì •ëœ ê°ì²´ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤.
ì¦‰, ì‚¬ìš©ìê°€ HTTP ìš”ì²­ íŒŒë¼ë¯¸í„°ì— ì„ì˜ì˜ ê°ì²´ ì†ì„±ê°’ì„ ì§€ì •í•˜ì—¬ ì „ì†¡í•˜ë©´ í•´ë‹¹ ê°ì²´ì˜ ì†ì„±ê°’ì´ ë³€ê²½ë  ìˆ˜ ìˆë‹¤.

### âœì·¨ì•½ì ê³¼ ê´€ë ¨ëœ ì½”ë“œ í™•ì¸

ì´ë¥¼ Githubì— ê³µê°œëœ Spring Framework ì½”ë“œì—ì„œ í™•ì¸í•´ë³¼ ìˆ˜ ìˆë‹¤.

<img src="images/CVE-2022-22965/call_getCachedIntrospectionResults.png" width="700" height="120"/>  

ìš”ì²­ ë§¤ê°œë³€ìˆ˜ ê°’ì„ ê°ì²´ì— ë°”ì¸ë”©í•  ë•Œ, `org.springframework.beans.BeanWrapperImpl`ì˜ `getCachedIntrospectionResults` ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ì—¬ ìºì‹œì— ê°ì²´ì˜ ì†ì„±ì„ ì €ì¥í•œë‹¤. 

<img src="images/CVE-2022-22965/getCachedIntrospectionResults.png" width="700" height="220"/>  

`getCachedIntrospectionResults`ë©”ì†Œë“œëŠ” `org.springframework.beans.CachedIntrospectionResults` í´ë˜ìŠ¤ì˜ `forClass` ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œë‹¤.

<img src="images/CVE-2022-22965/CachedIntrospectionResults_forClass.png" width="800" height="400"/> 

`org.springframework.beans.CachedIntrospectionResults`ë¥¼ í™•ì¸í•˜ë©´ `forClass` ë©”ì†Œë“œì—ì„œ ì•„ë˜ì²˜ëŸ¼ `CachedIntrospectionResults` ìƒì„±ìë¥¼ í˜¸ì¶œí•œë‹¤.

<img src="images/CVE-2022-22965/CachedIntrospectionResults_constructor.png" width="800" height="340"/> 

`org.springframework.beans.CachedIntrospectionResults`ì˜ ìƒì„±ì ì½”ë“œ ì¼ë¶€ë¥¼ ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤. 277ë¼ì¸ì„ ë³´ë©´ ìœ„ì—ì„œ ì–¸ê¸‰í•œ `getBeanInfo` ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<img src="images/CVE-2022-22965/patch_diff.png" width="800" height="260"/> 

íŒ¨ì¹˜ ì „í›„ë¥¼ í™•ì¸í•˜ë©´ íŒ¨ì¹˜ ì „ì—ëŠ” ê°ì²´ ì†ì„±ì— `classLoader` í˜¹ì€ `protectDomain` ë¬¸ìì—´ì´ í¬í•¨ëœ ê²½ìš° í•„í„°ë§í•˜ì—¬ ì œí•œí•  ìˆ˜ ìˆì—ˆë‹¤.
ì´ëŠ” `CVE-2022-22965` ì™€ ìœ ì‚¬í•œ ì·¨ì•½ì  `CVE-2010-1622`ì™€ ì—°ê´€ì´ ìˆë‹¤. `CVE-2010-1622` ì˜ ê²½ìš° `class.classLoader.URLs[0]={ì„ì˜ì˜ URL}` í˜•íƒœì˜ ì¡°ì‘ëœ ìš”ì²­ ë§¤ê°œ ë³€ìˆ˜ë¥¼ í¬í•¨í•œ ìš”ì²­ì„ ì „ì†¡í•´ ì·¨ì•½ì ì„ ë°œìƒì‹œí‚¬ ìˆ˜ ìˆì—ˆë‹¤.
ë”°ë¼ì„œ íŒ¨ì¹˜ ì „ì˜ í•„í„°ë§ìœ¼ë¡œ ì´ëŸ¬í•œ ë¬¸ìì—´ì€ í•„í„°ë§ í•  ìˆ˜ ìˆì—ˆë‹¤.

í•˜ì§€ë§Œ JDK 9ë¶€í„° `ClassLoader` ê°ì²´ì— ì ‘ê·¼í•  ìˆ˜ ìˆëŠ” `Moduel` ê°ì²´ê°€ ë“±ì¥í•˜ì˜€ê³ , `class.module.classloader`ë¥¼ í™œìš©í•´ ê¸°ì¡´ í•„í„°ë§ì„ ìš°íšŒí•´ ê³µê²©ì´ ê°€ëŠ¥í•´ì¡Œë‹¤.

ë”°ë¼ì„œ íŒ¨ì¹˜ í›„ì— í•´ë‹¹í•˜ëŠ” ì´ˆë¡ìƒ‰ ë¶€ë¶„ì„ í™•ì¸í•˜ë©´ ê°ì²´ ì†ì„±ì— ëŒ€í•œ í•„í„°ë§ì´ ê°•í™”ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

### âœExploit

LunaSecì´ ê³µê°œí•œ ì·¨ì•½í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ ë„ì»¤ íŒŒì¼ê³¼ PoCë¥¼ í™œìš©í•´ Exploitì„ ì¬í˜„í•˜ì˜€ë‹¤.

<img src="images/CVE-2022-22965/attack_packet_1.png" width="700" height="300"/> 

<img src="images/CVE-2022-22965/attack_packet_2.png" width="400" height="200"/> 

PoCë¥¼ ì‹¤í–‰í•˜ë©´ Wiresharkë¥¼ í†µí•´ ìœ„ì™€ ê°™ì€ ê³µê²© íŒ¨í‚·ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<img src="images/CVE-2022-22965/exploited.png" width="450" height="80"/> 

PoCë¥¼ ì‹¤í–‰í•œ í›„, ì·¨ì•½í•œ ì„œë²„ì—ëŠ” ì›¹ì‰˜ì´ ìƒì„±ë˜ê³  ìœ„ì™€ ê°™ì´ ì›¹ì‰˜ì— ì ‘ê·¼í•˜ê³ , ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.

íŠ¹íˆ ì²« ë²ˆì§¸ ê³µê²© íŒ¨í‚·ì—ì„œ `org.apache.catalina.valves.AccessLogValve` ê°ì²´ì˜ ì†ì„±ê°’ì„ ì„¤ì •í•˜ëŠ”ë°, ì´ ê°ì²´ëŠ” tomcat ë¡œê·¸ì— ê´€í•œ ê²ƒì´ë‹¤. 
`org.apache.catalina.valves.AccessLogValve`ê´€í•´ ì°¾ì•„ë³´ë‹ˆ `class.module.classLoader.resources.context.parent.pipeline.first.pattern`ì´ tomcat ë¡œê·¸ì˜ í˜•ì‹ì„ ì§€ì •í•˜ê¸° ìœ„í•œ ì†ì„±ì„ì„ ì•Œ ìˆ˜ ìˆì—ˆë‹¤. 

íŠ¹íˆ, PoCì—ì„œ ì‚¬ìš©í•œ `class.module.classLoader.resources.context.parent.pipeline.first.pattern`ê°’ì˜ URLì¸ì½”ë”©ëœ ë¶€ë¶„ì„ ë””ì½”ë”©í•œ í›„ì— í™•ì¸í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ë‹¤.

```java
%{prefix}i java.io.InputStream in = %{c}i.getRuntime().exec(request.getParameter("cmd")).getInputStream(); int a = -1; byte[] b = new byte[2048]; while((a=in.read(b))!=-1){ out.println(new String(b)); } %{suffix}i
```

ì—¬ê¸°ì„œ `%{prefix}i`, `%{c}i`, `%{suffix}i` ì™€ ê°™ì€ ê°’ì´ ë‚˜ì˜¤ëŠ”ë°, ì´ëŠ” ìš”ì²­ ë° ì‘ë‹µê°’ì„ í˜•ì‹ì— ë§ê²Œ ë¡œê¹…í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•˜ëŠ” í‘œí˜„ ì¤‘ í•˜ë‚˜ì´ë‹¤. tomcat documentì— ì˜í•˜ë©´ `%{xxx}i`ëŠ” ìš”ì²­ í—¤ë” `xxx`ì˜ ê°’ìœ¼ë¡œ ì¹˜í™˜í•˜ì—¬ ë¡œê·¸ì— ë‚¨ëŠ”ë‹¤.

> %{xxx}i write value of incoming header with name xxx (escaped if required)

ì¦‰, ë‘ ë²ˆì§¸ ê³µê²© íŒ¨í‚·(ì•„ë˜ì™€ ê°™ìŒ)ì—ì„œ HTTP ìš”ì²­ì—ì„œ `prefix`, `suffix`, `c` ì— í•´ë‹¹í•˜ëŠ” ê°’ì´ patternì— `%{prefix}i`, `%{c}i`, `%{suffix}i` ë¶€ë¶„ì— ì¹˜í™˜ë˜ì–´ `shell.jsp` íŒŒì¼ì— ì“°ì—¬ì§„ë‹¤. ì´ëŠ” ê³µê²©ìê°€ `<%`, `%>`, `Runtime`ê³¼ ê°™ì€ ë¬¸ìì—´ì— ëŒ€í•œ íƒì§€(ì‰˜ ì½”ë“œ ì—…ë¡œë“œ ë“±ì˜ ê³µê²© íƒì§€)ë¥¼ ìš°íšŒí•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œ ê²ƒìœ¼ë¡œ ìƒê°í•  ìˆ˜ ìˆì„ ê²ƒ ê°™ë‹¤.

```
GET /helloworld/greeting HTTP/1.1
Host: localhost:8080
User-Agent: python-requests/2.27.1
Accept-Encoding: gzip, deflate
Accept: */*
Connection: keep-alive
prefix: <%
suffix: %>//
c: Runtime
```

ë˜í•œ, Githubì— ê³µê°œëœ jsp ì½”ë“œë¥¼ í™œìš©í•´ ëŸ°íƒ€ì„ì— ì†ì„± ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆì—ˆë‹¤. ì•„ë˜ ì´ë¯¸ì§€ëŠ” í™•ì¸í•œ ì†ì„± ëª©ë¡ í˜ì´ì§€ë¥¼ ìº¡ì²˜í•œ ê²ƒì´ë©°, ê´€ë ¨ ì½”ë“œëŠ” `ğŸ”—ì°¸ê³ í•œ ìë£Œ [8]ë²ˆ`ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

<img src="images/CVE-2022-22965/properties.jpeg" width="600" height="650"/> 

ë˜í•œ ìœ„ì˜ jsp ì½”ë“œë¥¼ í™œìš©í•´ Exploit ì „í›„ì˜ `org.apache.catalina.valves.AccessLogValve` ì†ì„± ê°’ì„ í™•ì¸í•´ë³´ì•˜ë‹¤.

<img src="images/CVE-2022-22965/before.jpeg" width="620" height="200"/> 

ê¸°ì¡´ì—ëŠ” `conf/server.xml`ì— ì„¤ì •ëœ ê°’ê³¼ ì†ì„±ê°’ì´ ë™ì¼í–ˆë‹¤.

<img src="images/CVE-2022-22965/after.jpeg" width="620" height="200"/> 

ê³µê²© ì´í›„ì—ëŠ” PoCì— ì‚¬ìš©ëœ HTTP ìš”ì²­ íŒŒë¼ë¯¸í„° ê°’ê³¼ ë™ì¼í•˜ê²Œ ë³€ê²½ë˜ì—ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## ğŸ”—ì°¸ê³ í•œ ìë£Œ
[1] https://nvd.nist.gov/vuln/detail/CVE-2022-22965 (NVD)  
[2] https://spring.io/blog/2022/03/31/spring-framework-rce-early-announcement (ì·¨ì•½ì ê³¼ ê´€ë ¨ëœ Spring ê³µì§€ì‚¬í•­)  
[3] https://github.com/spring-projects/spring-framework/commit/002546b3e4b8d791ea6acccb81eb3168f51abb15 (Patch Diff)  
[4] https://www.lunasec.io/docs/blog/spring-rce-vulnerabilities/ (LunaSec ë¸”ë¡œê·¸ ë¶„ì„ê¸€)  
[5] https://github.com/lunasec-io/Spring4Shell-POC (LunaSec Spring4Shell PoC Github)  
[6] http://blog.o0o.nu/2010/06/cve-2010-1622.html (CV#-2010-1622)  
[7] https://github.com/WeiJiLab/Spring4Shell-POC/blob/master/src/main/webapps/print.jsp (ì†ì„± ëª©ë¡ì„ ì¶œë ¥í•˜ëŠ” ì½”ë“œ)  
[8] https://unit42.paloaltonetworks.com/cve-2022-22965-springshell/ (ì°¸ê³ í•œ ë¶„ì„ê¸€)  
[9] https://www.trendmicro.com/en_no/research/22/d/cve-2022-22965-analyzing-the-exploitation-of-spring4shell-vulner.html (ì°¸ê³ í•œ ë¶„ì„ê¸€)  
[10] https://docs.oracle.com/javase/9/docs/api/java/beans/Introspector.html  
[11] https://docs.oracle.com/javase/9/docs/api/java/beans/PropertyDescriptor.html  
[12] https://tomcat.apache.org/tomcat-9.0-doc/api/org/apache/catalina/valves/AccessLogValve.html  
[13] https://tomcat.apache.org/tomcat-9.0-doc/config/valve.html  
